<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif; /* Ensures the font is consistent */
            margin: 0;
            padding: 0;
            background-color: #e9ecef; /* Light background to keep it clean */
        }
        .widgets-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
            justify-content: space-around; /* Ensures widgets are spaced evenly */
        }
        .element {
            flex: 1 1 300px; /* Allows flex items to grow and shrink but not smaller than 300px */
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Subtle shadow for depth */
            margin-bottom: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
            padding: 20px 0;
        }
        h2 {
            text-align: center;
            color: #666;
        }
        label {
            font-weight: bold;
        }
        input[type="number"], select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box; /* Includes padding and border in the element's total width and height */
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            width: 300px; /* Set a fixed width for modal */
            display: none; /* Hide by default */
        }
        .modal-content {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
        }
        .modal button {
            width: auto;
            margin: 10px 5px 10px 0;
        }
    </style>
</head>
<body>
    <main id="mainArea">
        <h1>Welcome <%= current_user.name %></h1>
        <button id="filterBtn">Filter Widgets</button>
        <div class="widgets-container">
            <div class="element">
                <h2>Weight Lifting Tracker</h2>
                <div class="exercise-input">
                    <label for="exercise">Exercise:</label>
                    <select id="exercise">
                        <option value="deadlift">Deadlift</option>
                        <option value="shoulder press">Shoulder Press</option>
                        <option value="chest press">Chest Press</option>
                        <option value="squat">Squat</option>
                    </select>
                </div>
                <div class="set" id="defaultSet">
                    <label for="defaultWeight">Weight (lbs):</label>
                    <input type="number" class="weight" placeholder="Weight lifted">
                    <label for="defaultReps">Reps:</label>
                    <input type="number" class="reps" placeholder="Number of reps">
                </div>
                <div id="additionalSets">
                    <!-- Additional sets will be added here -->
                </div>
                <button id="addSet">Add Set</button>
                <button id="addExercise">Submit</button>
            </div>
            <div class="element">
                <h2>Cardio Tracker</h2>
                <div class="set" id="intensity">
                    <label for="defaultIntensity">Miles Ran:</label>
                    <input type="number" class="intensity" placeholder="Miles">
                </div>
                <div class="set" id="time">
                    <label for="defaultTime">Time (Minutes, Seconds):</label>
                    <input type="number" class="minutes" placeholder="Minutes">
                    <input type="number" class="seconds" placeholder="Seconds" min="0" max="60">
                </div>
                <button id="addCardio">Submit</button>
            </div>
            <div class="element">
                <h2>Planned Workout</h2>
                <div class="exercise-input">
                    <label>Exercise:</label>
                    <select id="exerciseP">
                        <option value="deadlift">Deadlift</option>
                        <option value="shoulderpress">Shoulder Press</option>
                        <option value="chestpress">Chest Press</option>
                        <option value="squat">Squat</option>
                    </select>
                </div>
                <div class="week-input">
                    <label for="week">Week:</label>
                    <select id="week">
                        <option value="week1">Week 1</option>
                        <option value="week2">Week 2</option>
                        <option value="week3">Week 3</option>
                        <option value="week4">Week 4</option>
                    </select>
                </div>
                <button id="PlannedWorkout">Submit</button>
                <div id="plannedTable" style="display: none;">
                    <table class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th>Set</th>
                                <th>Percentage</th>
                                <th>Reps</th>
                                <th>Weight (lbs)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td id="percentage1"></td>
                                <td id="reps1"></td>
                                <td><%= @deadlift1 %></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td id="percentage2"></td>
                                <td id="reps2"></td>
                                <td><%= @deadlift2 %></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td id="percentage3"></td>
                                <td id="reps3"></td>
                                <td><%= @deadlift3 %></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="element">
                <h2>Most Recent Workout</h2>
                <div class="workout-info">
                    <p><strong>Exercise:</strong> <%= @recent_exercise %></p>
                    <p><strong>Week:</strong> <%= @recent_week %></p>
                    <p><strong>Date:</strong> <%= @recent_date %></p>
                    <!-- Additional workout information -->
                </div>
            </div>
            <!-- Additional widgets can be added here -->
        </div>
    </main>

    <!-- All JavaScript code here -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // JavaScript code remains unchanged from the original implementation
        // Include your existing JavaScript handling for modals, adding sets, etc.
    </script>
</body>
</html>
<script>
// Filter elements on the dashboard
document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("filterBtn").addEventListener("click", function(event) {
        var modal = document.createElement("div");
        modal.className = "modal";
        modal.style.display = "block";

        var modalContent = document.createElement("div");
        modalContent.className = "modal-content";

        var elements = document.getElementsByClassName("element");
        for (var i = 0; i < elements.length; i++) {
            var checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = elements[i].style.display !== "none";
            checkbox.onchange = (function(element) {
                return function() {
                    element.style.display = this.checked ? "block" : "none";
                }
            })(elements[i]);

            var label = document.createElement("label");
            label.textContent = elements[i].querySelector("h2").textContent;
            label.insertBefore(checkbox, label.firstChild);
            modalContent.appendChild(label);
        }

        var closeButton = document.createElement("button");
        closeButton.textContent = "Close";
        closeButton.onclick = function() {
            modal.style.display = "none";
            document.body.removeChild(modal);
        };
        modalContent.appendChild(closeButton);

        modal.appendChild(modalContent);
        document.body.appendChild(modal);
    });
});

// Add a set to the Weight Widget
document.getElementById("addSet").addEventListener("click", function() {
    var additionalSetsDiv = document.getElementById("additionalSets");
    var defaultSet = document.getElementById("defaultSet");
    var newSet = defaultSet.cloneNode(true); // Clone the default set

    // Clear input fields in the cloned set
    newSet.querySelector(".weight").value = "";
    newSet.querySelector(".reps").value = "";

    additionalSetsDiv.appendChild(newSet); // Append the cloned set
});

// Add a new exercise to the Weight Widget
document.getElementById("addExercise").addEventListener("click", function() {
    var exerciseSelect = document.getElementById("exercise");
    var exercise = exerciseSelect.value;
    var weight = document.querySelector("#defaultSet .weight").value;
    var reps = document.querySelector("#defaultSet .reps").value;

    var additionalSets = [];
    var additionalSetsDiv = document.getElementById("additionalSets");
    var additionalSetsInputs = additionalSetsDiv.querySelectorAll(".set");

    // Loop through additional sets and collect their data
    additionalSetsInputs.forEach(function(set) {
        var weight = set.querySelector(".weight").value;
        var reps = set.querySelector(".reps").value;
        additionalSets.push({
            weight: weight,
            reps: reps
        });
    });

    // Prepare data to send to the server
    var data = {
        weight_tracker: {
            exercise: exercise,
            reps: reps,
            weight: weight
        },
        additional_sets: additionalSets
    };

    var csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');

    fetch('/weight_trackers', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
              'X-CSRF-Token': csrfToken
          },
          body: JSON.stringify(data)
      })
      .then(response => {
          if (!response.ok) {
              throw new Error('Network response was not ok');
          }
          return response.json();
      })
      .then(data => {
          console.log('Weight tracker created:', data);
          // If needed, handle success behavior here
      })
      .catch(error => {
          console.error('Error:', error);
          // If needed, handle error behavior here
      });

    // Clear input fields after submission
    document.querySelector("#defaultSet .weight").value = "";
    document.querySelector("#defaultSet .reps").value = "";
    additionalSetsDiv.innerHTML = ""; // Clear additional sets
});

// Add cardio exercise (save the data)
document.getElementById("addCardio").addEventListener("click", function() {
    var exerciseName = document.getElementById("exercise").value;
    var defaultMinutes = document.querySelector("#time .minutes").value;
    var defaultSeconds = document.querySelector("#time .seconds").value;
    var defaultIntensity = document.querySelector("#intensity .intensity").value;

    var set = {
        minutes: parseInt(defaultMinutes),
        seconds: parseInt(defaultSeconds),
        intensity: parseInt(defaultIntensity)
    };

    console.log("Exercise: " + exerciseName);
    console.log("Set: Minutes " + set.minutes + ", Seconds " + set.seconds + ", Intensity " + set.intensity);

    // Clear input fields after submission
    document.querySelector("#time .minutes").value = "";
    document.querySelector("#time .seconds").value = "";
    document.querySelector("#intensity .intensity").value = "";
});

// Planned Workout button logic
document.getElementById("PlannedWorkout").addEventListener("click", function() {
    var exerciseSelect = document.getElementById("exerciseP");
    var exerciseName = exerciseSelect.value;
    var weekSelect = document.getElementById("week");
    var week = weekSelect.value;

    // Define the percentages and reps based on the week
    var percentages = {
        'week1': ["65%", "75%", "85%"],
        'week2': ["70%", "80%", "90%"],
        'week3': ["75%", "85%", "95%"],
        'week4': ["40%", "50%", "60%"]
    };
    var reps = {
        'week1': ["x5", "x5", "x5+"],
        'week2': ["x3", "x3", "x3+"],
        'week3': ["x5", "x3", "x1+"],
        'week4': ["x5", "x5", "x5"]
    };

    document.getElementById("percentage1").textContent = percentages[week][0];
    document.getElementById("percentage2").textContent = percentages[week][1];
    document.getElementById("percentage3").textContent = percentages[week][2];
    document.getElementById("reps1").textContent = reps[week][0];
    document.getElementById("reps2").textContent = reps[week][1];
    document.getElementById("reps3").textContent = reps[week][2];

    var div = document.getElementById("plannedTable");
    div.style.display = "block"; // Show the planned workout table
});
	document.body.style.overflow = "auto";
</script>
